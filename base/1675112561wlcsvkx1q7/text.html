<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:xx-large; color:#404040; background-color:#ffffff;">Часто задаваемые вопросы по использованию аргументов командной строки</span></p>
<p style=" margin-top:20px; margin-bottom:20px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; font-weight:296; color:#3b3b3b;">13.02.2007</span><span style=" font-family:'Roboto'; font-size:14px; color:#43464b;"> </span><span style=" font-family:'inherit'; font-size:14px; font-weight:296; color:#3b3b3b;">Дик Льюис</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'inherit'; font-size:14px; font-weight:296; color:#808080; background-color:#ffffff;" style=" margin-top:0px; margin-bottom:5px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14px;">Ключевые слова :</span></li>
<li style=" font-family:'inherit'; font-size:14px; font-weight:496; color:#43464b;" style=" margin-top:0px; margin-bottom:5px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="tag_2562740"></a><a href="https://www.osp.ru/winitpro/articles/tag/2562740/"><span style=" font-size:14px; font-weight:400; background-color:transparent;">В</span></a><span style=" font-size:14px; font-weight:400; background-color:transparent;">опросы и Ответы</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'inherit'; font-size:14px; color:#6f6f6f;">После того как администратор создал и успешно запустил свой первый простой сценарий командной строки, он задумывается о том, как сделать так, чтобы было удобно повторно использовать данный сценарий при тестировании другого сервера или группы серверов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="lx_693476"></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">П</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">осле того как администратор создал и успешно запустил свой первый простой сценарий командной строки (скажем, для диагностики сервера с помощью утилиты ping), он задумывается о том, как сделать так, чтобы было удобно повторно использовать данный сценарий при тестировании другого сервера или группы серверов. В результате он может прийти к выводу, что наилучшим решением было бы предусмотреть возможность ввода в сценарий некоторых входных данных, которые можно изменять. Если жестко запрограммировать эти входные данные, то при каждом их изменении придется соответствующим образом редактировать код сценария. Например, если явно задать имя компьютера, на котором требуется выполнить те или иные операции, то перед каждым запуском сценария на другом компьютере придется редактировать код. Данный подход не просто неудобен, он может послужить причиной непреднамеренного изменения кода сценария и, соответственно, привести к его некорректной работе. Предпочтительнее сохранить код сценария «в неприкосновенности» после его отладки, что обеспечит его нормальную работу в дальнейшем.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Если входные данные, которые предполагается передавать сценарию, имеют незначительный объем, тогда весьма эффективным решением для организации их ввода будет использование аргументов командной строки. Создав сценарий, управляемый аргументами, впоследствии можно легко преобразовать его для использования других технологий ввода данных в соответствии с новыми требованиями. Альтернативные технологии ввода данных рассматриваются во врезке </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#vr"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">«Возможные способы ввода данных»</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">. Чтобы помочь читателям разобраться в том, как работать с аргументами командной строки и избегать типичных ошибок, я собрал в данной статье несколько наиболее часто задаваемых вопросов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#43464b;">В. Одна из часто используемых мною утилит требует указания около 10 различных ключей и параметров. Поэтому перед каждым ее запуском мне приходится просматривать справочную систему и вспоминать, какой именно синтаксис вызова я использовал в последний раз. Я написал специальный сценарий, который мне приходится каждый раз редактировать. При этом я обнаружил, что фактически требуется изменять только три параметра. Могу ли я использовать аргументы командной строки для передачи этих параметров сценарию, когда мне нужно в очередной раз запустить данную утилиту?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> Создание сценариев для запуска из них утилит пакета Resource Kit или программ независимых разработчиков — прекрасная возможность для применения аргументов командной строки, особенно в тех случаях, когда запускаемая программа имеет строку вызова, содержащую несколько сложных ключей. Причем в большинстве случаев утилита, скорее всего, запускается с одним и тем же набором ключей. Я, например, для переноса больших объемов данных часто пользуюсь утилитой Robocopy (из набора Microsoft Windows Resource Kit) — программой, имеющей множество различных ключей запуска. Если создать сценарий, который будет выполнять большую часть операций, реализуемых программой, можно, во-первых, сэкономить время, а во-вторых, гарантировать точность результатов работы данной утилиты. Для этого нужно просто прописать в сценарии те ключи, которые вы обычно не изменяете, и передавать ему в виде аргументов значения тех ключей, которые приходится изменять часто. Однако при этом следует понимать, что случайное добавление и удаление каких-либо ключей при работе с Robocopy может привести к неприятным последствиям — например, могут быть перемещены какие-то важные файлы, которые предполагалось только скопировать, либо пунктом назначения для файлов оказался NTFS-ресурс, к которому отсутствуют необходимые разрешения доступа.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">В </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#lis1"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">листинге 1</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> показан сценарий RoboArg.bat, который представляет собой пример запуска утилиты Robocopy. При запуске сценария из командной строки ему должны быть переданы два аргумента. Ниже приведена строка запуска этого сценария:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">RoboArg.bat &quot;C:sourcefiles&quot; </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />&quot;D:destinationfiles&quot;</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">где C:sourcefiles — путь к файлам, которые требуется скопировать, а D:destinationfiles указывает местоположение каталога, в который нужно скопировать данные файлы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">В среде Windows существует специальная группа переменных окружения для поддержки работы с аргументами сценариев командной строки: они имеют обозначения от %0 до %9. Эти переменные могут использоваться для передачи входной информации сценарию при его выполнении. При этом переменная %1 определяет первый аргумент, вводимый в командной строке, переменная %2 — второй и т. д. Таким образом, в сценарии RoboArg.bat переменными %1 и %2 определяются соответственно исходный и конечный файлы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">В начале сценария RoboArg.bat выполняют две процедуры проверки, чтобы удостовериться в том, что было введено правильное количество аргументов. В первой из них используется команда IF, с помощью которой значение аргумента %2 сравнивается с пустой строкой. При выявлении совпадения выводится предупреждение о том, что введено недостаточное количество аргументов, после чего сценарий завершает работу. Вторая проверка заключается в том, что с помощью оператора GTR (что означает «больше, чем», т. е. это эквивалентно символу «&gt;») определяется, содержит ли переменная %3 какое-либо значение. Оператор GTR служит для сравнения двух величин. Если первая величина больше, чем вторая, то результатом сравнения будет TRUE и будут выполняться те команды, которые следуют в данной строке за оператором сравнения. Если же первая величина не больше второй, то результатом сравнения будет FALSE, поэтому исполнительный механизм обработки сценария не будет выполнять остальные команды, имеющиеся в этой строке, а перейдет к обработке следующей строки сценария. Хотя оператор GTR обычно используется как математический, здесь я применил его для проверки существования значений. При создании сценариев командной строки проверка того, содержит ли некоторая переменная какое-либо значение, всегда является более надежной, чем попытка убедиться, что эта переменная не содержит ничего. Если переменная %3 является пустой, то ее содержимое не может быть больше 1, тогда сценарий игнорирует оставшиеся в этой строке команды и переходит к следующей строке, в которой производится запуск утилиты Robocopy. Если же переменная %3 имеет не пустое значение, то эта величина будет больше 1, поэтому данная строка будет обработана полностью, в результате чего будет выведено сообщение Too many arguments («Слишком много аргументов»), а затем сценарий завершит работу. Несколько других подходов к обработке аргументов кратко рассматриваются во врезке </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#vr1"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">«Методы работы с аргументами»</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#43464b;">В. Я понимаю, что переменные %1 и %2 соответствуют первому и второму аргументу. А имеет ли какое-либо назначение переменная %0?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> Да, переменная %0 определяет путь к сценарию. Чтобы увидеть использование переменной %0 в действии, следует запустить сценарий TestVar.bat, показанный в </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#lis2"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">листинге 2</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Возможность получения данных о каталоге размещения сценария является весьма полезной. Допустим, требуется, чтобы сценарий сам определял местонахождение других используемых файлов (таких, как утилиты, входные и выходные файлы). В этом случае для получения информации о размещении можно задействовать переменную %0 в сочетании с командой CALL. После этого сценарий можно разместить на любом сервере и в любом каталоге, и он будет корректно работать, причем изменения в него вносить не придется. В </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#lis3"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">листинге 3</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> показан пример сценария Test0Var.bat, в котором имеется процедура CALL, которую можно применить для реализации подобной функции автопоиска.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">В данном примере использование параметра командного файла %∼dp1 демонстрирует возможность подстановки параметров, которая весьма полезна во многих операциях, выполняемых в сценариях. В </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#t1"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">табл. 1 </span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">перечислено несколько вариантов использования параметров командного файла. Обратите внимание, что %∼dp1 представляет собой комбинацию параметров %∼d1 и %∼p1, каждый из которых определяет соответственно букву, обозначающую диск, и путь. Полный перечень вариантов использования этих параметров можно увидеть, запустив команду CALL с ключом /?.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#43464b;">В. Если использовать для определения местонахождения .bat-файла не сочетание параметров командного файла %∼dp1, а переменную окружения %CD%, то не будет ли это более простым решением?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> С помощью переменной %CD% можно определить место, из которого запускается сценарий. Но это место не обязательно должно соответствовать тому каталогу, в котором он размещается.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#43464b;">В. Я знаю, что аргументам сценария могут соответствовать только девять переменных (от %1 до %9). Каково максимальное количество символов и аргументов, которое я могу ввести в командной строке?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> Максимальное количество вводимых символов будет зависеть от типа используемой операционной системы и от пути к сценарию, длина которого тоже будет иметь значение для максимального количества символов, которые могут быть введены в командной строке. В Windows 2000 это значение соответствует примерно 2045 символам и пробелам. Однако, если вы собираетесь вводить столь значительное число символов в командной строке, будьте готовы к тому, что придется выполнять проверку корректности введенной информации. Также следует иметь в виду, что оболочка командной строки не всегда выводит сообщение об ошибке при превышении максимального количества символов. Если вам все же необходимо использовать очень длинные строки ввода или большое количество этих строк, советую размещать их во входном файле, который затем обрабатывать сценарием.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Что касается вопроса о максимальном количестве аргументов, то здесь единственным ограничением будет максимальное количество символов и разделителей (т.е. намного больше, чем нужно). В обычной ситуации вам доступны только девять аргументов, однако с помощью команды SHIFT можно задействовать дополнительные аргументы. Для получения более подробной информации о синтаксисе этой команды следует запустить ее в виде SHIFT /?.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">В </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#lis4"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">листинге 4</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> показан сценарий TestLotsOfArgs.bat script, в котором приводится пример обработки неограниченного количества аргументов. Данный код также демонстрирует, как можно обнаруживать, что никаких аргументов вводить не требуется. В данном примере выполняется запуск утилиты ping для каждого аргумента server-name.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">В. При запуске утилиты DSQuery я попытался указать в качестве аргумента строку ADsPath, однако в таком виде она не работает. Синтаксис запуска сценария выглядел следующим образом:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#333333;">MyScript.bat ou=server,dc=sales,dc=mycompany, dc=com</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">Что я сделал неправильно?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> Типичным символом разделителя аргументов является пробел, однако допускается также использование других символов для разделения аргументов (таких, как запятая или точка с запятой). Поэтому для того, чтобы использовать в качестве аргумента строку ADsPath, нужно заключать ее в двойные кавычки, тогда сценарий не будет интерпретировать запятые как разделители. В некоторых случаях после того, как аргумент передан внутрь сценария, может потребоваться удалить символы двойных кавычек. Для этого можно использовать подстановку, что показано в примере </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#lis5"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">листинга 5</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">. Данный код представляет собой весьма удобный способ удаления или замены символов и может использоваться для организации фильтрации двойных кавычек. Базовый синтаксис выглядит следующим образом: %PATH:str1=str2%. Более подробные сведения о подстановках переменных можно получить, набрав в командной строке команду SET /?.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Если вы запустили команду CALL /?, как описывалось выше, то наверняка обнаружили еще один метод удаления двойных кавычек. В </span><a href="https://www.osp.ru/win2000/2007/01/4037709/#lis6"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">листинге 6</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> показан пример использования команды CALL для фильтрации двойных кавычек.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Запомните, что если строка аргумента содержит пробелы или еще какие-либо символы, которые могут трактоваться как разделители, то для того, чтобы сценарий воспринимал строку как единый аргумент, она должна заключаться в двойные кавычки. Типичным примером входных данных сценария, в которых могут содержаться пробелы, являются описания путей к входным и выходным файлам, а также к файлам журналов. Кроме того, желательно заключать в кавычки адреса электронной почты, разделенные запятыми или точкой с запятой.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#43464b;">В. Имеется сценарий, у которого есть три аргумента. Могу ли я присвоить аргументам метки таким образом, чтобы можно было указывать их в любом порядке, а потом проверить, что все три аргумента переданы сценарию и ничего не потерялось?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> Да, можно создать такой сценарий, у которого есть три аргумента, для которых используются метки. В качестве примера я разработал второй вариант сценария для запуска Robocopy, который называется AdvancedArguments ForRobo.bat, приведенный в </span><a href="https://www.osp.ru/winitpro/2007/01/083_lis7.htm"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">листинге 7</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">. Здесь используется набор из трех стандартных аргументов, которым далее присваиваются метки. В результате параметры размещения исходного, целевого файла, а также файла журнала могут указываться в произвольном порядке. Синтаксис запуска сценария выглядит следующим образом:</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">AdvancedArgumentsForRobo.bat </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />/S:&quot;D:sourcelocation&quot; <br />/D:&quot;serverdestinationlocation&quot; <br />/L:&quot;D:logfileslog.txt&quot;.</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Здесь /S определяет местонахождение исходного файла (source), /D задает местонахождение целевого (destination) файла, а /L соответствует месту размещения файла журнала (log) работы программы Robocopy. Обратите внимание, что можно задавать как локальные, так и доступные сетевые каталоги.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">При работе с аргументами я рекомендую руководствоваться приведенными ниже основными принципами, которым я следовал при создании сценария AdvancedArgumentsForRobo.bat.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Если пользователь попытается запустить сценарий без аргументов, необходимо вывести экран справки, содержащий подсказки для корректного ввода аргументов.</span></li>
<li style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">По возможности выполняйте проверку правильности ввода аргументов. Например, в сценарии, показанном в листинге 7, для проверки существования каталогов источника и пункта назначения используется оператор IF EXIST. Кроме того, если вы работаете с аргументами, имеющими метки, желательно проверять, не задан ли какой-либо из них дважды и не пропущен ли какой-либо из аргументов. Как реализовать подобную проверку, показано во фрагменте кода с меткой A в листинге 7.</span></li>
<li style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Предоставьте пользователю возможность принять окончательное решение перед запуском процедур. Эта возможность особенно важна в тех случаях, когда в сценарии выполняются операции, связанные с изменением, копированием или удалением файлов, учетных записей пользователей, членов групп и т. д. Если сценарий задействует только функции чтения или выполняет те или иные запросы, то наличие данной возможности не столь принципиально, однако я все равно советую реализовывать ее. В тех случаях когда предполагается использовать сценарий для запуска тех или иных операций по расписанию, будет целесообразно игнорировать или исключить из него код, требующий ввода данных пользователем.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#43464b;">В. Можно ли использовать аргументы при работе с ярлыками и в планировщике заданий?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> Аргументы можно задавать в ярлыках и указателях планировщика заданий, однако я рекомендую добавлять аргументы по завершении процесса создания ярлыка или работы мастера создания задачи Task Setup Wizard. В ходе работы мастера создайте указатель на .bat файл, а затем добавьте аргументы вручную. Если описание пути к сценарию содержит пробелы, не забудьте заключить его — но не аргументы сценария! — в двойные кавычки. Если при создании ярлыков используется утилита shortcut.exe (средство для создания ярлыков Microsoft), то в этом случае для задания аргументов можно использовать ключ -a данной утилиты.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; color:#43464b;">В. Можете ли Вы порекомендовать какой-либо быстрый способ использования аргументов командной строки без необходимости ввода аргументов с клавиатуры для исключения возможных ошибок ввода?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">О.</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> Для того чтобы сделать ввод команд более точным, я пользуюсь несколькими приемами. Прежде всего, в диалоговом окне свойств Properties командной строки нужно выбрать режимы быстрого редактирования QuickEdit Mode и вставки Insert Mode. Это позволит копировать текст из окна командной строки, а также вставлять его туда. Первое, что вводится в командной строке, — это путь к сценарию. Следует понимать, что длинный путь к сценарию создаст массу дополнительных хлопот. Одна маленькая опечатка может привести к появлению ошибок.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">На мой взгляд, самым простым способом быстрого поиска пути к сценарию является использование свободно распространяемой утилиты SAMenu от Smaller Animals Software. Это небольшое расширение проводника Windows дает возможность копировать путь к файлу в буфер обмена путем выбора соответствующего пункта из контекстного меню, вызываемого правой кнопкой мыши. Для этого нужно просто щелкнуть правой кнопкой на файле сценария и выбрать пункт Copy Path to Clipboard. Далее щелчком правой кнопкой мыши в окне командной строки можно перенести скопированное значение пути к сценарию в командную строку. Аналогичным образом можно вводить в командную строку пути к другим файлам и каталогам. Также можно использовать перетаскивание необходимых файлов в окно командной строки: следует просто выбрать свой сценарий и перетащить его мышью в окно командной строки, нажав на левую или правую кнопку.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Как мы видели, данные можно копировать в окно командной строки, однако при этом следует соблюдать осторожность. Допустим, вы хотите скопировать в окно командной строки путь к файлу и набор аргументов, которые берете, скажем, из текстового файла, а эти данные содержат символ возврата каретки. Тогда при вставке этих данных в командную строку сценарий будет запущен на выполнение немедленно.</span></p>
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Используйте аргументы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Возможность передачи входных данных — это ключ к созданию весьма эффективных сценариев и упрощению их использования. Использование аргументов для работы с входными данными — надежное, проверенное временем решение. Вы можете убедиться в этом, загрузив прилагающийся к данной статье код и протестировав эти сценарии в своей инфраструктуре. Они предоставят несколько новых методик, которые пополнят ваш арсенал приемов разработки сценариев.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#43464b;">Дик Льюис</span><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;"> (</span><a href="mailto:dlewis@winnetmag.com"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#23527c; background-color:transparent;">dlewis@winnetmag.com</span></a><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">) — Старший системный инженер компании CKT Consulting в Калифорнии. Имеет сертификаты MCSE и MCT, специализируется на системах управления масштаба предприятия.</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Возможные способы ввода данных</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Использование аргументов в командной строке традиционно считается оптимальным вариантом для реализации ввода внешних данных в сценарии. Но существуют и альтернативные способы.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Например, в Windows NT и последующих версиях с помощью команды For /F можно выполнять построчное считывание данных из входного файла. В тех случаях когда вводимые внешние данные имеют большой объем — скажем, список из 200 компьютеров или 500 пользователей, — обработка входного файла может оказаться предпочтительным решением. При этом можно разработать сценарий, в котором аргументы будут использоваться для передачи информации о размещении входного и выходного файлов; таким образом, применение технологии обработки файлов не исключает возможности использования аргументов.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Еще один вариант ввода данных — с помощью меню. Если потенциальные пользователи сценария не имеют опыта работы с этим инструментом, можно предложить им статическое меню с приглашением для ввода текста. Наилучшими альтернативами в этом случае являются команда Choice из пакета Microsoft Windows Resource Kit, а также команда Set /P из операционной системы Windows.</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Методы работы с аргументами</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;">Для работы с аргументами можно выбрать один из нескольких подходов. В идеале хочется сделать так, чтобы процедура ввода аргументов была максимально простой и интуитивно понятной для пользователя, при этом гарантировалась бы высокая точность ввода данных. В зависимости от данных, которые требуется передать сценарию в качестве аргументов, определяется оптимальный способ работы с ними. Если вы не уверены, что выбранный способ работы с аргументами оправдан и интуитивно понятен, передайте сценарий на некоторое время в тестовую эксплуатацию нескольким пользователям, а потом попросите их высказать свое мнение по результатам тестирования. Ниже приводится три основных подхода к работе с аргументами.</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">Располагайте аргументы по порядку. Порядок следования аргументов указывает на то, что представляет собой каждый из них. Многие утилиты из пакетов Resource Kit, а также программы от независимых производителей принимают входные данные через аргументы, упорядоченные определенным образом. Примером данного подхода может служить сценарий копирования файлов из одного места в другое, использующий утилиту Robocopy. Здесь логический порядок следования аргументов будет таким: размещение исходного файла, размещение целевого файла, размещение файла журнала. Если в данном случае поменять местами источник и пункт назначения, то файлы из пункта назначения будут переписаны поверх исходных файлов.</span></li>
<li style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">При работе с аргументами используйте метки. Например, можно задать метки таким образом, чтобы сценарий понимал, что аргументу, перед которым стоит метка /S, соответствует файл-источник, а аргумент, указанный после метки /D, - это пункт назначения. Использование маркированных аргументов исключит возможность появления последовательных ошибок в упомянутом выше примере с запуском утилиты Robocopy. Но если вы решили использовать этот подход, то в вашем сценарии должна быть предусмотрена процедура предварительного перехвата аргументов и удаления из них информации о метках. Пример его реализации показан в листинге 7.</span></li>
<li style=" font-family:'Helvetica Neue,Helvetica,Arial,sans-serif'; font-size:16px; color:#43464b;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:16px;">В некоторых сценариях все аргументы могут быть просто элементами списка однотипных объектов, передаваемых сценарию. Примером может служить сценарий Ping, который запускает утилиту ping для каждого из серверов, чьи имена были переданы ему в качестве аргументов. Если вы собираетесь использовать данный подход, то необходимо организовать внутри сценария некоторый цикл, который бы последовательно брал каждый из имеющихся аргументов и запускал для него соответствующую процедуру. Пример реализации такой процедуры в сценарии был показан в листинге 4, где с помощью утилиты ping опрашивался список серверов, имена которых были переданы сценарию в виде аргументов.</span></li></ul>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Листинг 1. RoboArg.bat</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">If “%2”==”” Echo Недостаточное количество аргументов &amp; goto :EOF </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />If %3 GTR 1 Echo Слишком много аргументов &amp; goto :EOF <br />Robocopy %1 %2 /E /PURGE /SEC /NP /R:1 /W:1</span></pre>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Листинг 2. TestVar.bat</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">BEGIN COMMENT </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />:: Для запуска сценария используйте команду <br />:: TestVar.bat переменная1 переменная2 переменная3. <br />END COMMENT <br />Echo Путь к сценарию: %0 <br />Echo Первая переменная: %1 <br />Echo Вторая переменная: %2 <br />Echo Третья переменая: %3</span></pre>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Листинг 3. Test0Var.bat</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">BEGIN COMMENT </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />:: Для запуска сценария используйте команду <br />:: Test0Var.bat. <br />END COMMENT <br />Call :GetPath %0 <br />Goto :EOF <br /> <br />:GetPath <br />Echo. <br />BEGIN COMMENT <br />:: Расширяем %0 буквой диска и путем <br />END COMMENT <br />Echo Путь: %∼dp1 <br />BEGIN COMMENT <br />:: Создание выходного файла по указанному пути. <br />END COMMENT <br />Set OutFile=%∼dp1outputfile.txt <br />Dir /AD /B &gt; %OutFile% <br />Goto :EOF</span></pre>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Листинг 4. TestLotsOfArgs.bat</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">BEGIN COMMENT </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />:: Для запуска сценария используйте следующую команду, <br />:: в которой укажите несколько имен своих серверов: <br />:: TestLotsOfArgs.bat Server1 Server2 Server3 Server4 <br />:: Server5 Server6 Server7 Server8 Server9 Server10 <br />:: Server11 Server12 <br />END COMMENT <br />@Echo Off <br />Setlocal <br />Set counter=0 <br />If '%1'=='' Echo Не заданы аргументы servername &amp; Goto :last <br />Set /A counter+=1 <br />Echo ARG %counter%)	%1 <br />Ping -n 1 %1 <br />Set ARGStr=%1 <br /> <br />:TOP <br /> <br />If '%2'=='' Goto :last <br />Set /A counter+=1 <br />Echo ARG %counter%)	%2 <br />Ping -n 1 %2 <br />Set ARGStr=%ARGStr% %2 <br />Shift /1 <br />Goto :TOP <br /> <br />:last <br /> <br />Echo Здесь приведена вновь собранная строка аргументов: %ARGStr% <br />Endlocal <br />Goto :EOF</span></pre>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Листинг 5. Фильтрация двойных кавычек</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">:: Call the script MyScriptWoQuotes.bat. </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />&quot;ou=server,dc=sales,dc=mycompany,dc=com&quot; <br />Set ADsPath=%1 <br />Echo Аргумент, содержащий кавычки: %ADsPath% <br />Set ADsPath=%ADsPath:&quot;=% <br />Echo Аргумент без кавычек: %ADsPath%</span></pre>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Листинг 6. Фильтрация двойных кавычек с помощью команды Call</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#f5f5f5;"><span style=" font-family:'Courier New'; font-size:16px; color:#333333; background-color:#f5f5f5;">@Echo Off </span><span style=" font-family:'Courier New'; font-size:16px; color:#333333;"><br />Set ADSpath=&quot;ou=server,dc=sales,dc=mycompany,dc=com&quot; <br />Echo Аргумент, содержащий кавычки: %ADSpath% <br />Call :remquotes %ADSpath% <br />Goto :EOF <br /> <br />:remquotes <br />Set ADsPath=%∼1 <br />Echo Аргумент без кавычек: %ADsPath% <br />Goto :EOF</span></pre>
<hr />
<p style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:32px;"><span style=" font-family:'inherit'; font-size:medium; color:#404040;">Таблица. Варианты использования параметров командных файлов</span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0" bgcolor="transparent">
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#000000;">Параметр</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; font-weight:600; color:#000000;">Функция</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼f1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на полное описание пути (fully qualified pathname)</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼d1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на буквенное обозначение диска (только)</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼p1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на описание пути (только)</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼n1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на имя файла (только)</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼x1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на расширение файла (только)</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼a1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на атрибуты файла</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼t1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на время/дату создания файла</span></p></td></tr>
<tr>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">%∼z1</span></p></td>
<td style=" padding-left:10; padding-right:10; padding-top:10; padding-bottom:10;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:18px;"><span style=" font-family:'inherit'; font-size:16px; color:#000000;">Заменяет %1 на размер файла</span></p></td></tr></table></body></html>